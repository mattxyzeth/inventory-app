<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weekly Todo</title>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f0f2f5;
    color: #1a1a2e;
    min-height: 100vh;
    padding: 2rem 1rem;
  }

  .container {
    max-width: 900px;
    margin: 0 auto;
  }

  header {
    text-align: center;
    margin-bottom: 2rem;
  }

  header h1 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #1a1a2e;
  }

  header p {
    color: #6b7280;
    margin-top: 0.25rem;
    font-size: 0.95rem;
  }

  .week-nav {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .week-nav button {
    background: #fff;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    padding: 0.4rem 0.8rem;
    cursor: pointer;
    font-size: 0.9rem;
    color: #374151;
    transition: background 0.15s;
  }

  .week-nav button:hover { background: #f3f4f6; }

  .week-nav span {
    font-weight: 600;
    font-size: 1rem;
    min-width: 220px;
    text-align: center;
  }

  .add-bar {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    background: #fff;
    padding: 0.75rem;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
  }

  .add-bar input[type="text"] {
    flex: 1;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    padding: 0.5rem 0.75rem;
    font-size: 0.95rem;
    outline: none;
    transition: border-color 0.15s;
  }

  .add-bar input[type="text"]:focus { border-color: #6366f1; }

  .add-bar select {
    border: 1px solid #d1d5db;
    border-radius: 8px;
    padding: 0.5rem;
    font-size: 0.9rem;
    background: #fff;
    cursor: pointer;
    outline: none;
  }

  .add-bar button {
    background: #6366f1;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.5rem 1.2rem;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.15s;
    white-space: nowrap;
  }

  .add-bar button:hover { background: #4f46e5; }

  .days-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1rem;
  }

  .day-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    overflow: hidden;
  }

  .day-card.today { box-shadow: 0 0 0 2px #6366f1, 0 1px 3px rgba(0,0,0,0.08); }

  .day-header {
    padding: 0.65rem 0.85rem;
    font-weight: 700;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.03em;
    background: #f9fafb;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .day-card.today .day-header {
    background: #eef2ff;
    color: #4338ca;
  }

  .day-header .date-label {
    font-weight: 400;
    font-size: 0.8rem;
    text-transform: none;
    color: #9ca3af;
  }

  .day-card.today .day-header .date-label { color: #6366f1; }

  .day-tasks {
    padding: 0.5rem;
    min-height: 48px;
  }

  .task-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.45rem 0.4rem;
    border-radius: 8px;
    transition: background 0.12s;
  }

  .task-item:hover { background: #f9fafb; }

  .task-item input[type="checkbox"] {
    margin-top: 3px;
    width: 16px;
    height: 16px;
    accent-color: #6366f1;
    cursor: pointer;
    flex-shrink: 0;
  }

  .task-text {
    flex: 1;
    font-size: 0.92rem;
    line-height: 1.4;
    word-break: break-word;
  }

  .task-item.done .task-text {
    text-decoration: line-through;
    color: #9ca3af;
  }

  .task-delete {
    background: none;
    border: none;
    color: #d1d5db;
    cursor: pointer;
    font-size: 1.1rem;
    line-height: 1;
    padding: 0 2px;
    flex-shrink: 0;
    transition: color 0.15s;
  }

  .task-delete:hover { color: #ef4444; }

  .empty-day {
    text-align: center;
    color: #d1d5db;
    font-size: 0.85rem;
    padding: 0.75rem 0;
  }

  .stats {
    text-align: center;
    margin-top: 1.5rem;
    font-size: 0.85rem;
    color: #9ca3af;
  }

  .clear-done {
    background: none;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    padding: 0.3rem 0.7rem;
    font-size: 0.8rem;
    color: #6b7280;
    cursor: pointer;
    margin-left: 0.5rem;
    transition: background 0.15s;
  }

  .clear-done:hover { background: #f3f4f6; }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>Weekly Todo</h1>
    <p>Organize your tasks by day</p>
  </header>

  <div class="week-nav">
    <button id="prevWeek">&larr; Prev</button>
    <span id="weekLabel"></span>
    <button id="todayBtn">Today</button>
    <button id="nextWeek">Next &rarr;</button>
  </div>

  <div class="add-bar">
    <input type="text" id="taskInput" placeholder="Add a new task..." />
    <select id="daySelect"></select>
    <button id="addBtn">Add</button>
  </div>

  <div class="days-grid" id="daysGrid"></div>

  <div class="stats" id="stats"></div>
</div>

<script>
const STORAGE_KEY = 'weekly_todos';
const DAY_NAMES = ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'];

let weekOffset = 0;

function getMonday(d) {
  const date = new Date(d);
  const day = date.getDay();
  const diff = date.getDate() - day + (day === 0 ? -6 : 1);
  date.setDate(diff);
  date.setHours(0,0,0,0);
  return date;
}

function getCurrentMonday() {
  const now = new Date();
  const monday = getMonday(now);
  monday.setDate(monday.getDate() + weekOffset * 7);
  return monday;
}

function dateKey(date) {
  return date.toISOString().split('T')[0];
}

function formatDate(date) {
  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
}

function loadTasks() {
  try {
    return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
  } catch { return {}; }
}

function saveTasks(tasks) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
}

function getWeekDates() {
  const monday = getCurrentMonday();
  return DAY_NAMES.map((_, i) => {
    const d = new Date(monday);
    d.setDate(monday.getDate() + i);
    return d;
  });
}

function render() {
  const dates = getWeekDates();
  const tasks = loadTasks();
  const todayStr = dateKey(new Date());
  const monday = dates[0];
  const sunday = dates[6];

  document.getElementById('weekLabel').textContent =
    `${formatDate(monday)} \u2013 ${formatDate(sunday)}, ${sunday.getFullYear()}`;

  // Day select
  const sel = document.getElementById('daySelect');
  const prevVal = sel.value;
  sel.innerHTML = '';
  dates.forEach((d, i) => {
    const opt = document.createElement('option');
    const dk = dateKey(d);
    opt.value = dk;
    opt.textContent = DAY_NAMES[i];
    if (dk === todayStr) opt.selected = true;
    sel.appendChild(opt);
  });
  if (prevVal && [...sel.options].some(o => o.value === prevVal)) sel.value = prevVal;

  // Grid
  const grid = document.getElementById('daysGrid');
  grid.innerHTML = '';

  let total = 0, done = 0;

  dates.forEach((d, i) => {
    const dk = dateKey(d);
    const isToday = dk === todayStr;
    const dayTasks = tasks[dk] || [];

    const card = document.createElement('div');
    card.className = 'day-card' + (isToday ? ' today' : '');

    const header = document.createElement('div');
    header.className = 'day-header';
    header.innerHTML = `<span>${DAY_NAMES[i]}</span><span class="date-label">${formatDate(d)}</span>`;
    card.appendChild(header);

    const body = document.createElement('div');
    body.className = 'day-tasks';

    if (dayTasks.length === 0) {
      body.innerHTML = '<div class="empty-day">No tasks</div>';
    } else {
      dayTasks.forEach((task, ti) => {
        total++;
        if (task.done) done++;

        const item = document.createElement('div');
        item.className = 'task-item' + (task.done ? ' done' : '');

        const cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.checked = task.done;
        cb.addEventListener('change', () => toggleTask(dk, ti));

        const text = document.createElement('span');
        text.className = 'task-text';
        text.textContent = task.text;

        const del = document.createElement('button');
        del.className = 'task-delete';
        del.textContent = '\u00d7';
        del.title = 'Delete';
        del.addEventListener('click', () => deleteTask(dk, ti));

        item.append(cb, text, del);
        body.appendChild(item);
      });
    }

    card.appendChild(body);
    grid.appendChild(card);
  });

  const statsEl = document.getElementById('stats');
  if (total > 0) {
    statsEl.innerHTML = `${done}/${total} tasks done this week`;
    if (done > 0) {
      statsEl.innerHTML += `<button class="clear-done" onclick="clearDone()">Clear completed</button>`;
    }
  } else {
    statsEl.textContent = 'No tasks this week';
  }
}

function addTask() {
  const input = document.getElementById('taskInput');
  const text = input.value.trim();
  if (!text) return;

  const day = document.getElementById('daySelect').value;
  const tasks = loadTasks();
  if (!tasks[day]) tasks[day] = [];
  tasks[day].push({ text, done: false });
  saveTasks(tasks);
  input.value = '';
  render();
}

function toggleTask(day, index) {
  const tasks = loadTasks();
  if (tasks[day] && tasks[day][index]) {
    tasks[day][index].done = !tasks[day][index].done;
    saveTasks(tasks);
    render();
  }
}

function deleteTask(day, index) {
  const tasks = loadTasks();
  if (tasks[day]) {
    tasks[day].splice(index, 1);
    if (tasks[day].length === 0) delete tasks[day];
    saveTasks(tasks);
    render();
  }
}

function clearDone() {
  const tasks = loadTasks();
  const dates = getWeekDates();
  dates.forEach(d => {
    const dk = dateKey(d);
    if (tasks[dk]) {
      tasks[dk] = tasks[dk].filter(t => !t.done);
      if (tasks[dk].length === 0) delete tasks[dk];
    }
  });
  saveTasks(tasks);
  render();
}

document.getElementById('addBtn').addEventListener('click', addTask);
document.getElementById('taskInput').addEventListener('keydown', e => {
  if (e.key === 'Enter') addTask();
});
document.getElementById('prevWeek').addEventListener('click', () => { weekOffset--; render(); });
document.getElementById('nextWeek').addEventListener('click', () => { weekOffset++; render(); });
document.getElementById('todayBtn').addEventListener('click', () => { weekOffset = 0; render(); });

render();
</script>
</body>
</html>
